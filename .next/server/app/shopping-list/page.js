(()=>{var e={};e.id=414,e.ids=[414],e.modules={177:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>s.a,__next_app__:()=>p,pages:()=>c,routeModule:()=>h,tree:()=>d});var n=r(5239),a=r(8088),i=r(8170),s=r.n(i),o=r(893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let d={children:["",{children:["shopping-list",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,8128)),"/Users/martin.varnai/Projects/lunchplanner/lunchplanner-web/src/app/shopping-list/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,4431)),"/Users/martin.varnai/Projects/lunchplanner/lunchplanner-web/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,5284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/martin.varnai/Projects/lunchplanner/lunchplanner-web/src/app/shopping-list/page.tsx"],p={require:r,loadChunk:()=>Promise.resolve()},h=new n.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/shopping-list/page",pathname:"/shopping-list",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},440:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var n=r(1658);let a=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,n.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},722:(e,t,r)=>{Promise.resolve().then(r.bind(r,8128))},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1135:()=>{},1297:(e,t,r)=>{"use strict";r.d(t,{B2:()=>w,DR:()=>h,Hg:()=>u,IF:()=>x,NL:()=>y,NV:()=>d,T2:()=>c,XU:()=>m,Zy:()=>l,lu:()=>p,nm:()=>f,rr:()=>g});var n=r(4298);let a=[],i=[],s=[],o=()=>{let e=[],t=new Date;for(let r=0;r<7;r++){let n=new Date(t);n.setDate(t.getDate()+r),e.push({date:n.toISOString().split("T")[0],meals:[]})}return e},l=async()=>{try{return[...a=await n.cQ.getAll()]}catch(e){return console.error("Failed to fetch ingredients:",e),[]}},d=async e=>{try{let t=await n.cQ.create(e);return a.push(t),t}catch(e){throw console.error("Failed to add ingredient:",e),e}},c=async(e,t)=>{try{let r=await n.cQ.update(e,t);return a=a.map(t=>t.id===e?r:t),i=i.map(r=>({...r,ingredients:r.ingredients.map(r=>r.ingredientId===e?{...r,name:t}:r)})),r}catch(e){throw console.error("Failed to update ingredient:",e),e}},p=async e=>{try{await n.cQ.delete(e),a=a.filter(t=>t.id!==e);let t=i.find(t=>t.ingredients.some(t=>t.ingredientId===e));return{success:!t,mealWithIngredient:t}}catch(e){throw console.error("Failed to delete ingredient:",e),e}},h=async()=>{try{return[...i=await n.gw.getAll()]}catch(e){return console.error("Failed to fetch meals:",e),[]}},u=async(e,t)=>{try{let r=await n.gw.create(e,t);return i.push(r),r}catch(e){throw console.error("Failed to add meal:",e),e}},m=async(e,t,r)=>{try{let a=await n.gw.update(e,t,r);return i=i.map(t=>t.id===e?a:t),a}catch(t){throw console.error(`Failed to update meal ${e}:`,t),t}},g=async e=>{try{return await n.gw.delete(e),i=i.filter(t=>t.id!==e),s=s.map(t=>({...t,meals:t.meals.filter(t=>t!==e)})),{success:!0}}catch(t){throw console.error(`Failed to delete meal ${e}:`,t),t}},y=async()=>{try{return[...s=await n.a7.getAll()]}catch(e){return console.error("Failed to fetch meal plan:",e),0===s.length&&(s=o()),[...s]}},w=async(e,t)=>{try{let r=await n.a7.updateDay(e,t);return s=s.map(t=>t.date===e?r:t),r}catch(r){return console.error(`Failed to update plan for ${e}:`,r),(s=s.map(r=>r.date===e?{...r,meals:t}:r)).find(t=>t.date===e)}},x=async()=>{try{return await n.a7.reset(),s=o()}catch(e){return console.error("Failed to reset meal plan:",e),s=o()}},f=async()=>{try{return await n.a7.getShoppingList()}catch(t){console.error("Failed to fetch shopping list:",t);let e=new Map;return s.forEach(t=>{t.meals.forEach(t=>{let r=i.find(e=>e.id===t);r&&r.ingredients.forEach(t=>{e.has(t.ingredientId)?e.get(t.ingredientId)?.quantity.push(t.quantity):e.set(t.ingredientId,{name:t.name,quantity:[t.quantity]})})})}),Array.from(e.entries()).map(([e,{name:t,quantity:r}])=>({ingredientId:e,name:t,quantity:r.join(", ")}))}}},1743:()=>{},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3812:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,6444,23)),Promise.resolve().then(r.t.bind(r,6042,23)),Promise.resolve().then(r.t.bind(r,8170,23)),Promise.resolve().then(r.t.bind(r,9477,23)),Promise.resolve().then(r.t.bind(r,9345,23)),Promise.resolve().then(r.t.bind(r,2089,23)),Promise.resolve().then(r.t.bind(r,6577,23)),Promise.resolve().then(r.t.bind(r,1307,23))},3873:e=>{"use strict";e.exports=require("path")},4282:(e,t,r)=>{Promise.resolve().then(r.bind(r,9546))},4298:(e,t,r)=>{"use strict";r.d(t,{R2:()=>o,a7:()=>c,cQ:()=>l,gw:()=>d});let n=()=>null,a=e=>{},i=()=>{},s=async(e,t={})=>{let r=n(),a={"Content-Type":"application/json",...r?{Authorization:`Bearer ${r}`}:{},...t.headers||{}},s=await fetch(`http://localhost:3000/api${e}`,{...t,headers:a});if(401===s.status)throw i(),Error("Unauthorized");let o=await s.json();if(!s.ok)throw Error(o.message||"API request failed");return o},o={register:async(e,t,r)=>{let n=await s("/auth/register",{method:"POST",body:JSON.stringify({name:e,email:t,password:r})});return n.token&&a(n.token),n},login:async(e,t)=>{let r=await s("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})});return r.token&&a(r.token),r},logout:()=>{i()},getCurrentUser:async()=>await s("/auth/me"),changePassword:async(e,t)=>await s("/auth/change-password",{method:"POST",body:JSON.stringify({currentPassword:e,newPassword:t})})},l={getAll:async()=>await s("/ingredients"),getById:async e=>await s(`/ingredients/${e}`),create:async e=>await s("/ingredients",{method:"POST",body:JSON.stringify({name:e})}),update:async(e,t)=>await s(`/ingredients/${e}`,{method:"PUT",body:JSON.stringify({name:t})}),delete:async e=>await s(`/ingredients/${e}`,{method:"DELETE"})},d={getAll:async()=>await s("/meals"),getById:async e=>await s(`/meals/${e}`),create:async(e,t)=>await s("/meals",{method:"POST",body:JSON.stringify({title:e,ingredients:t})}),update:async(e,t,r)=>await s(`/meals/${e}`,{method:"PUT",body:JSON.stringify({title:t,ingredients:r})}),delete:async e=>await s(`/meals/${e}`,{method:"DELETE"})},c={getAll:async()=>await s("/plans"),updateDay:async(e,t)=>await s(`/plans/${e}`,{method:"PUT",body:JSON.stringify({mealIds:t})}),reset:async()=>await s("/plans",{method:"DELETE"}),getShoppingList:async()=>await s("/plans/shopping-list")}},4431:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i,metadata:()=>a});var n=r(7413);r(1135);let a={title:"Lunch Planner",description:"Plan your meals and generate shopping lists"};function i({children:e}){return(0,n.jsx)("html",{lang:"en",children:(0,n.jsxs)("body",{children:[(0,n.jsx)("main",{className:"min-h-screen",children:e}),(0,n.jsx)("footer",{className:"p-4",style:{backgroundColor:"white",borderTop:"1px solid var(--border-color)",textAlign:"center"},children:(0,n.jsx)("div",{className:"container",children:(0,n.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," Lunch Planner App"]})})})]})})}},4951:()=>{},6964:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,6346,23)),Promise.resolve().then(r.t.bind(r,7924,23)),Promise.resolve().then(r.t.bind(r,5656,23)),Promise.resolve().then(r.t.bind(r,99,23)),Promise.resolve().then(r.t.bind(r,8243,23)),Promise.resolve().then(r.t.bind(r,8827,23)),Promise.resolve().then(r.t.bind(r,2763,23)),Promise.resolve().then(r.t.bind(r,7173,23))},8128:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});let n=(0,r(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/martin.varnai/Projects/lunchplanner/lunchplanner-web/src/app/shopping-list/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/martin.varnai/Projects/lunchplanner/lunchplanner-web/src/app/shopping-list/page.tsx","default")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9546:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var n=r(687),a=r(3210);function i(){let[e,t]=(0,a.useState)([]),[r,i]=(0,a.useState)([]),[s,o]=(0,a.useState)([]),[l,d]=(0,a.useState)({}),[c,p]=(0,a.useState)(!1),[h,u]=(0,a.useState)(""),m=e=>{d({...l,[e]:!l[e]})},g=e=>new Date(e).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),y=e=>e.map(e=>s.find(t=>t.id===e)?.title||"Unknown meal");return(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{children:"Shopping List"}),(0,n.jsx)("p",{className:"mb-4",children:"Based on your meal plan, here's what you need to buy."}),h&&(0,n.jsx)("div",{className:"card",style:{backgroundColor:"#ffebee",marginBottom:"1rem"},children:(0,n.jsx)("p",{style:{color:"var(--error-color)"},children:h})}),(0,n.jsxs)("div",{className:"card",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)("h2",{children:"Your Shopping List"}),(0,n.jsx)("button",{onClick:()=>{let t=window.open("","_blank");if(!t)return;let r=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Shopping List</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          h1 { margin-bottom: 20px; }
          ul { padding-left: 20px; }
          li { margin-bottom: 8px; }
        </style>
      </head>
      <body>
        <h1>Shopping List</h1>
        <ul>
          ${e.map(e=>`<li>${e.name}: ${e.quantity}</li>`).join("")}
        </ul>
      </body>
      </html>
    `;t.document.open(),t.document.write(r),t.document.close(),t.print()},disabled:c||0===e.length,children:"Print List"})]}),c?(0,n.jsx)("p",{children:"Loading shopping list..."}):0===e.length?(0,n.jsx)("div",{children:(0,n.jsx)("p",{children:"Your shopping list is empty. Add meals to your meal plan first."})}):(0,n.jsx)("ul",{style:{listStyle:"none",padding:0},children:e.map(e=>(0,n.jsxs)("li",{className:"flex items-center gap-2 p-4",style:{borderBottom:"1px solid var(--border-color)",textDecoration:l[e.ingredientId]?"line-through":"none",opacity:l[e.ingredientId]?.5:1},children:[(0,n.jsx)("input",{type:"checkbox",checked:!!l[e.ingredientId],onChange:()=>m(e.ingredientId),style:{width:"auto",marginBottom:0}}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("strong",{children:[e.name,":"]})," ",e.quantity]})]},e.ingredientId))})]}),(0,n.jsxs)("div",{className:"card mt-4",children:[(0,n.jsx)("h2",{children:"Meal Plan Summary"}),c?(0,n.jsx)("p",{children:"Loading meal plan..."}):0===r.filter(e=>e.meals.length>0).length?(0,n.jsx)("p",{children:"No meals planned yet."}):(0,n.jsx)("ul",{children:r.map(e=>e.meals.length>0&&(0,n.jsxs)("li",{style:{marginBottom:"10px"},children:[(0,n.jsxs)("strong",{children:[g(e.date),":"]})," ",y(e.meals).join(", ")]},e.date))})]})]})}r(1297)},9551:e=>{"use strict";e.exports=require("url")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[447,825,658],()=>r(177));module.exports=n})();