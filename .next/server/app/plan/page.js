(()=>{var e={};e.id=624,e.ids=[624],e.modules={440:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var a=r(1658);let n=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1135:()=>{},1297:(e,t,r)=>{"use strict";r.d(t,{B2:()=>f,DR:()=>p,Hg:()=>u,IF:()=>x,NL:()=>g,NV:()=>d,T2:()=>c,XU:()=>m,Zy:()=>o,lu:()=>h,nm:()=>w,rr:()=>y});var a=r(4298);let n=[],s=[],i=[],l=()=>{let e=[],t=new Date;for(let r=0;r<7;r++){let a=new Date(t);a.setDate(t.getDate()+r),e.push({date:a.toISOString().split("T")[0],meals:[]})}return e},o=async()=>{try{return[...n=await a.cQ.getAll()]}catch(e){return console.error("Failed to fetch ingredients:",e),[]}},d=async e=>{try{let t=await a.cQ.create(e);return n.push(t),t}catch(e){throw console.error("Failed to add ingredient:",e),e}},c=async(e,t)=>{try{let r=await a.cQ.update(e,t);return n=n.map(t=>t.id===e?r:t),s=s.map(r=>({...r,ingredients:r.ingredients.map(r=>r.ingredientId===e?{...r,name:t}:r)})),r}catch(e){throw console.error("Failed to update ingredient:",e),e}},h=async e=>{try{await a.cQ.delete(e),n=n.filter(t=>t.id!==e);let t=s.find(t=>t.ingredients.some(t=>t.ingredientId===e));return{success:!t,mealWithIngredient:t}}catch(e){throw console.error("Failed to delete ingredient:",e),e}},p=async()=>{try{return[...s=await a.gw.getAll()]}catch(e){return console.error("Failed to fetch meals:",e),[]}},u=async(e,t)=>{try{let r=await a.gw.create(e,t);return s.push(r),r}catch(e){throw console.error("Failed to add meal:",e),e}},m=async(e,t,r)=>{try{let n=await a.gw.update(e,t,r);return s=s.map(t=>t.id===e?n:t),n}catch(t){throw console.error(`Failed to update meal ${e}:`,t),t}},y=async e=>{try{return await a.gw.delete(e),s=s.filter(t=>t.id!==e),i=i.map(t=>({...t,meals:t.meals.filter(t=>t!==e)})),{success:!0}}catch(t){throw console.error(`Failed to delete meal ${e}:`,t),t}},g=async()=>{try{return[...i=await a.a7.getAll()]}catch(e){return console.error("Failed to fetch meal plan:",e),0===i.length&&(i=l()),[...i]}},f=async(e,t)=>{try{let r=await a.a7.updateDay(e,t);return i=i.map(t=>t.date===e?r:t),r}catch(r){return console.error(`Failed to update plan for ${e}:`,r),(i=i.map(r=>r.date===e?{...r,meals:t}:r)).find(t=>t.date===e)}},x=async()=>{try{return await a.a7.reset(),i=l()}catch(e){return console.error("Failed to reset meal plan:",e),i=l()}},w=async()=>{try{return await a.a7.getShoppingList()}catch(t){console.error("Failed to fetch shopping list:",t);let e=new Map;return i.forEach(t=>{t.meals.forEach(t=>{let r=s.find(e=>e.id===t);r&&r.ingredients.forEach(t=>{e.has(t.ingredientId)?e.get(t.ingredientId)?.quantity.push(t.quantity):e.set(t.ingredientId,{name:t.name,quantity:[t.quantity]})})})}),Array.from(e.entries()).map(([e,{name:t,quantity:r}])=>({ingredientId:e,name:t,quantity:r.join(", ")}))}}},1743:()=>{},2465:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>h,pages:()=>c,routeModule:()=>p,tree:()=>d});var a=r(5239),n=r(8088),s=r(8170),i=r.n(s),l=r(893),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let d={children:["",{children:["plan",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,8324)),"/Users/martin.varnai/Projects/lunchplanner/lunchplanner-web/src/app/plan/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,4431)),"/Users/martin.varnai/Projects/lunchplanner/lunchplanner-web/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,5284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/martin.varnai/Projects/lunchplanner/lunchplanner-web/src/app/plan/page.tsx"],h={require:r,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/plan/page",pathname:"/plan",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3058:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var a=r(687),n=r(3210),s=r(1297);function i(){let[e,t]=(0,n.useState)([]),[r,i]=(0,n.useState)([]),[l,o]=(0,n.useState)(null),[d,c]=(0,n.useState)([]),[h,p]=(0,n.useState)(!1),[u,m]=(0,n.useState)(!1),[y,g]=(0,n.useState)(""),f=e=>{o(e.date),c([...e.meals]),p(!0)},x=async()=>{if(l){m(!0);try{await (0,s.B2)(l,d);let e=await (0,s.NL)();t(e),p(!1)}catch(e){console.error("Error updating plan:",e),g("Failed to update meal plan. Please try again.")}finally{m(!1)}}},w=async()=>{if(confirm("Are you sure you want to reset the entire meal plan?")){m(!0);try{await (0,s.IF)();let e=await (0,s.NL)();t(e)}catch(e){console.error("Error resetting plan:",e),g("Failed to reset meal plan. Please try again.")}finally{m(!1)}}},b=e=>{d.includes(e)?c(d.filter(t=>t!==e)):c([...d,e])},v=e=>new Date(e).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),P=e=>e.map(e=>r.find(t=>t.id===e)?.title||"Unknown meal").join(", ");return(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{children:"Meal Plan"}),(0,a.jsx)("p",{className:"mb-4",children:"Plan your meals for the upcoming days."}),y&&(0,a.jsx)("div",{className:"card",style:{backgroundColor:"#ffebee",marginBottom:"1rem"},children:(0,a.jsx)("p",{style:{color:"var(--error-color)"},children:y})}),(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{children:"Weekly Plan"}),(0,a.jsx)("button",{onClick:w,style:{backgroundColor:"var(--error-color)"},disabled:u,children:u?"Resetting...":"Reset Plan"})]}),(0,a.jsx)("div",{className:"card",children:u&&0===e.length?(0,a.jsx)("p",{children:"Loading meal plan..."}):(0,a.jsx)("div",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))"},children:e.map(e=>(0,a.jsxs)("div",{className:"card",style:{cursor:"pointer"},onClick:()=>f(e),children:[(0,a.jsx)("h3",{children:v(e.date)}),0===e.meals.length?(0,a.jsx)("p",{style:{color:"#888"},children:"No meals planned"}):(0,a.jsx)("p",{children:P(e.meals)}),(0,a.jsx)("div",{className:"text-right mt-4",children:(0,a.jsx)("button",{className:"secondary",disabled:u,children:"Edit"})})]},e.date))})}),h&&(0,a.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,a.jsxs)("div",{className:"card",style:{maxWidth:"500px",width:"100%",maxHeight:"80vh",overflow:"auto"},onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("h2",{children:["Select Meals for ",l&&v(l)]}),(0,a.jsx)("div",{className:"mb-4",style:{marginTop:"1rem"},children:0===r.length?(0,a.jsx)("p",{children:"No meals available. Create some meals first."}):(0,a.jsx)("div",{children:r.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("input",{type:"checkbox",id:`meal-${e.id}`,checked:d.includes(e.id),onChange:()=>b(e.id),style:{width:"auto",marginBottom:0},disabled:u}),(0,a.jsx)("label",{htmlFor:`meal-${e.id}`,children:e.title})]},e.id))})}),(0,a.jsxs)("div",{className:"flex justify-between mt-4",children:[(0,a.jsx)("button",{className:"secondary",onClick:()=>p(!1),disabled:u,children:"Cancel"}),(0,a.jsx)("button",{onClick:x,disabled:u,children:u?"Saving...":"Save"})]})]})})]})}},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3812:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,6444,23)),Promise.resolve().then(r.t.bind(r,6042,23)),Promise.resolve().then(r.t.bind(r,8170,23)),Promise.resolve().then(r.t.bind(r,9477,23)),Promise.resolve().then(r.t.bind(r,9345,23)),Promise.resolve().then(r.t.bind(r,2089,23)),Promise.resolve().then(r.t.bind(r,6577,23)),Promise.resolve().then(r.t.bind(r,1307,23))},3873:e=>{"use strict";e.exports=require("path")},4298:(e,t,r)=>{"use strict";r.d(t,{R2:()=>l,a7:()=>c,cQ:()=>o,gw:()=>d});let a=()=>null,n=e=>{},s=()=>{},i=async(e,t={})=>{let r=a(),n={"Content-Type":"application/json",...r?{Authorization:`Bearer ${r}`}:{},...t.headers||{}},i=await fetch(`http://localhost:3000/api${e}`,{...t,headers:n});if(401===i.status)throw s(),Error("Unauthorized");let l=await i.json();if(!i.ok)throw Error(l.message||"API request failed");return l},l={register:async(e,t,r)=>{let a=await i("/auth/register",{method:"POST",body:JSON.stringify({name:e,email:t,password:r})});return a.token&&n(a.token),a},login:async(e,t)=>{let r=await i("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})});return r.token&&n(r.token),r},logout:()=>{s()},getCurrentUser:async()=>await i("/auth/me"),changePassword:async(e,t)=>await i("/auth/change-password",{method:"POST",body:JSON.stringify({currentPassword:e,newPassword:t})})},o={getAll:async()=>await i("/ingredients"),getById:async e=>await i(`/ingredients/${e}`),create:async e=>await i("/ingredients",{method:"POST",body:JSON.stringify({name:e})}),update:async(e,t)=>await i(`/ingredients/${e}`,{method:"PUT",body:JSON.stringify({name:t})}),delete:async e=>await i(`/ingredients/${e}`,{method:"DELETE"})},d={getAll:async()=>await i("/meals"),getById:async e=>await i(`/meals/${e}`),create:async(e,t)=>await i("/meals",{method:"POST",body:JSON.stringify({title:e,ingredients:t})}),update:async(e,t,r)=>await i(`/meals/${e}`,{method:"PUT",body:JSON.stringify({title:t,ingredients:r})}),delete:async e=>await i(`/meals/${e}`,{method:"DELETE"})},c={getAll:async()=>await i("/plans"),updateDay:async(e,t)=>await i(`/plans/${e}`,{method:"PUT",body:JSON.stringify({mealIds:t})}),reset:async()=>await i("/plans",{method:"DELETE"}),getShoppingList:async()=>await i("/plans/shopping-list")}},4431:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s,metadata:()=>n});var a=r(7413);r(1135);let n={title:"Lunch Planner",description:"Plan your meals and generate shopping lists"};function s({children:e}){return(0,a.jsx)("html",{lang:"en",children:(0,a.jsxs)("body",{children:[(0,a.jsx)("main",{className:"min-h-screen",children:e}),(0,a.jsx)("footer",{className:"p-4",style:{backgroundColor:"white",borderTop:"1px solid var(--border-color)",textAlign:"center"},children:(0,a.jsx)("div",{className:"container",children:(0,a.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," Lunch Planner App"]})})})]})})}},4951:()=>{},6964:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,6346,23)),Promise.resolve().then(r.t.bind(r,7924,23)),Promise.resolve().then(r.t.bind(r,5656,23)),Promise.resolve().then(r.t.bind(r,99,23)),Promise.resolve().then(r.t.bind(r,8243,23)),Promise.resolve().then(r.t.bind(r,8827,23)),Promise.resolve().then(r.t.bind(r,2763,23)),Promise.resolve().then(r.t.bind(r,7173,23))},8264:(e,t,r)=>{Promise.resolve().then(r.bind(r,3058))},8324:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/martin.varnai/Projects/lunchplanner/lunchplanner-web/src/app/plan/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/martin.varnai/Projects/lunchplanner/lunchplanner-web/src/app/plan/page.tsx","default")},8536:(e,t,r)=>{Promise.resolve().then(r.bind(r,8324))},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9551:e=>{"use strict";e.exports=require("url")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[447,825,658],()=>r(2465));module.exports=a})();