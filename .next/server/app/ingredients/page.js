(()=>{var e={};e.id=653,e.ids=[653],e.modules={440:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1658);let a=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,r.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1135:()=>{},1297:(e,t,n)=>{"use strict";n.d(t,{B2:()=>x,DR:()=>u,Hg:()=>p,IF:()=>f,NL:()=>y,NV:()=>d,T2:()=>c,XU:()=>m,Zy:()=>o,lu:()=>h,nm:()=>b,rr:()=>g});var r=n(4298);let a=[],i=[],s=[],l=()=>{let e=[],t=new Date;for(let n=0;n<7;n++){let r=new Date(t);r.setDate(t.getDate()+n),e.push({date:r.toISOString().split("T")[0],meals:[]})}return e},o=async()=>{try{return[...a=await r.cQ.getAll()]}catch(e){return console.error("Failed to fetch ingredients:",e),[]}},d=async e=>{try{let t=await r.cQ.create(e);return a.push(t),t}catch(e){throw console.error("Failed to add ingredient:",e),e}},c=async(e,t)=>{try{let n=await r.cQ.update(e,t);return a=a.map(t=>t.id===e?n:t),i=i.map(n=>({...n,ingredients:n.ingredients.map(n=>n.ingredientId===e?{...n,name:t}:n)})),n}catch(e){throw console.error("Failed to update ingredient:",e),e}},h=async e=>{try{await r.cQ.delete(e),a=a.filter(t=>t.id!==e);let t=i.find(t=>t.ingredients.some(t=>t.ingredientId===e));return{success:!t,mealWithIngredient:t}}catch(e){throw console.error("Failed to delete ingredient:",e),e}},u=async()=>{try{return[...i=await r.gw.getAll()]}catch(e){return console.error("Failed to fetch meals:",e),[]}},p=async(e,t)=>{try{let n=await r.gw.create(e,t);return i.push(n),n}catch(e){throw console.error("Failed to add meal:",e),e}},m=async(e,t,n)=>{try{let a=await r.gw.update(e,t,n);return i=i.map(t=>t.id===e?a:t),a}catch(t){throw console.error(`Failed to update meal ${e}:`,t),t}},g=async e=>{try{return await r.gw.delete(e),i=i.filter(t=>t.id!==e),s=s.map(t=>({...t,meals:t.meals.filter(t=>t!==e)})),{success:!0}}catch(t){throw console.error(`Failed to delete meal ${e}:`,t),t}},y=async()=>{try{return[...s=await r.a7.getAll()]}catch(e){return console.error("Failed to fetch meal plan:",e),0===s.length&&(s=l()),[...s]}},x=async(e,t)=>{try{let n=await r.a7.updateDay(e,t);return s=s.map(t=>t.date===e?n:t),n}catch(n){return console.error(`Failed to update plan for ${e}:`,n),(s=s.map(n=>n.date===e?{...n,meals:t}:n)).find(t=>t.date===e)}},f=async()=>{try{return await r.a7.reset(),s=l()}catch(e){return console.error("Failed to reset meal plan:",e),s=l()}},b=async()=>{try{return await r.a7.getShoppingList()}catch(t){console.error("Failed to fetch shopping list:",t);let e=new Map;return s.forEach(t=>{t.meals.forEach(t=>{let n=i.find(e=>e.id===t);n&&n.ingredients.forEach(t=>{e.has(t.ingredientId)?e.get(t.ingredientId)?.quantity.push(t.quantity):e.set(t.ingredientId,{name:t.name,quantity:[t.quantity]})})})}),Array.from(e.entries()).map(([e,{name:t,quantity:n}])=>({ingredientId:e,name:t,quantity:n.join(", ")}))}}},1552:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var r=n(687),a=n(5814),i=n.n(a),s=n(6189),l=n(4298);function o(){let e=(0,s.usePathname)();return(0,r.jsx)("header",{className:"p-4",style:{backgroundColor:"white",borderBottom:"1px solid var(--border-color)"},children:(0,r.jsxs)("div",{className:"container flex justify-between items-center",children:[(0,r.jsx)("h1",{style:{margin:0,fontSize:"1.5rem"},children:"\uD83C\uDF7Dï¸ Lunch Planner"}),(0,r.jsx)("nav",{children:(0,r.jsxs)("ul",{className:"flex gap-4",style:{listStyle:"none",margin:0},children:[(0,r.jsx)("li",{children:(0,r.jsx)(i(),{href:"/",style:{fontWeight:"/"===e?"bold":"normal",textDecoration:"/"===e?"underline":"none"},children:"Home"})}),(0,r.jsx)("li",{children:(0,r.jsx)(i(),{href:"/ingredients",style:{fontWeight:"/ingredients"===e?"bold":"normal",textDecoration:"/ingredients"===e?"underline":"none"},children:"Ingredients"})}),(0,r.jsx)("li",{children:(0,r.jsx)(i(),{href:"/meals",style:{fontWeight:"/meals"===e?"bold":"normal",textDecoration:"/meals"===e?"underline":"none"},children:"Meals"})}),(0,r.jsx)("li",{children:(0,r.jsx)(i(),{href:"/plan",style:{fontWeight:"/plan"===e?"bold":"normal",textDecoration:"/plan"===e?"underline":"none"},children:"Meal Plan"})}),(0,r.jsx)("li",{children:(0,r.jsx)(i(),{href:"/shopping-list",style:{fontWeight:"/shopping-list"===e?"bold":"normal",textDecoration:"/shopping-list"===e?"underline":"none"},children:"Shopping List"})}),(0,r.jsx)("li",{children:(0,r.jsx)("button",{onClick:()=>{l.R2.logout(),window.location.href="/login"},className:"link-button",children:"Logout"})})]})})]})})}var d=n(3210);function c({children:e}){let[t,n]=(0,d.useState)(!0);return((0,s.useRouter)(),t)?(0,r.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,r.jsx)("p",{children:"Loading..."})}):(0,r.jsx)(r.Fragment,{children:e})}function h({children:e}){return(0,r.jsxs)(c,{children:[(0,r.jsx)(o,{}),(0,r.jsx)("main",{className:"container p-4",children:e})]})}},1743:()=>{},2393:(e,t,n)=>{Promise.resolve().then(n.bind(n,7389))},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3812:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,6444,23)),Promise.resolve().then(n.t.bind(n,6042,23)),Promise.resolve().then(n.t.bind(n,8170,23)),Promise.resolve().then(n.t.bind(n,9477,23)),Promise.resolve().then(n.t.bind(n,9345,23)),Promise.resolve().then(n.t.bind(n,2089,23)),Promise.resolve().then(n.t.bind(n,6577,23)),Promise.resolve().then(n.t.bind(n,1307,23))},3873:e=>{"use strict";e.exports=require("path")},4298:(e,t,n)=>{"use strict";n.d(t,{R2:()=>l,a7:()=>c,cQ:()=>o,gw:()=>d});let r=()=>null,a=e=>{},i=()=>{},s=async(e,t={})=>{let n=r(),a={"Content-Type":"application/json",...n?{Authorization:`Bearer ${n}`}:{},...t.headers||{}},s=await fetch(`http://localhost:3000/api${e}`,{...t,headers:a});if(401===s.status)throw i(),Error("Unauthorized");let l=await s.json();if(!s.ok)throw Error(l.message||"API request failed");return l},l={register:async(e,t,n)=>{let r=await s("/auth/register",{method:"POST",body:JSON.stringify({name:e,email:t,password:n})});return r.token&&a(r.token),r},login:async(e,t)=>{let n=await s("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})});return n.token&&a(n.token),n},logout:()=>{i()},getCurrentUser:async()=>await s("/auth/me"),changePassword:async(e,t)=>await s("/auth/change-password",{method:"POST",body:JSON.stringify({currentPassword:e,newPassword:t})})},o={getAll:async()=>await s("/ingredients"),getById:async e=>await s(`/ingredients/${e}`),create:async e=>await s("/ingredients",{method:"POST",body:JSON.stringify({name:e})}),update:async(e,t)=>await s(`/ingredients/${e}`,{method:"PUT",body:JSON.stringify({name:t})}),delete:async e=>await s(`/ingredients/${e}`,{method:"DELETE"})},d={getAll:async()=>await s("/meals"),getById:async e=>await s(`/meals/${e}`),create:async(e,t)=>await s("/meals",{method:"POST",body:JSON.stringify({title:e,ingredients:t})}),update:async(e,t,n)=>await s(`/meals/${e}`,{method:"PUT",body:JSON.stringify({title:t,ingredients:n})}),delete:async e=>await s(`/meals/${e}`,{method:"DELETE"})},c={getAll:async()=>await s("/plans"),updateDay:async(e,t)=>await s(`/plans/${e}`,{method:"PUT",body:JSON.stringify({mealIds:t})}),reset:async()=>await s("/plans",{method:"DELETE"}),getShoppingList:async()=>await s("/plans/shopping-list")}},4431:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i,metadata:()=>a});var r=n(7413);n(1135);let a={title:"Lunch Planner",description:"Plan your meals and generate shopping lists"};function i({children:e}){return(0,r.jsx)("html",{lang:"en",children:(0,r.jsxs)("body",{children:[(0,r.jsx)("main",{className:"min-h-screen",children:e}),(0,r.jsx)("footer",{className:"p-4",style:{backgroundColor:"white",borderTop:"1px solid var(--border-color)",textAlign:"center"},children:(0,r.jsx)("div",{className:"container",children:(0,r.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," Lunch Planner App"]})})})]})})}},4951:()=>{},6029:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GlobalError:()=>s.a,__next_app__:()=>h,pages:()=>c,routeModule:()=>u,tree:()=>d});var r=n(5239),a=n(8088),i=n(8170),s=n.n(i),l=n(893),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);n.d(t,o);let d={children:["",{children:["ingredients",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(n.bind(n,7339)),"/Users/martin.varnai/Projects/lunchplanner/lunchplanner-web/src/app/ingredients/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(n.bind(n,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(n.bind(n,4431)),"/Users/martin.varnai/Projects/lunchplanner/lunchplanner-web/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(n.t.bind(n,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(n.t.bind(n,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(n.t.bind(n,5284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(n.bind(n,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/martin.varnai/Projects/lunchplanner/lunchplanner-web/src/app/ingredients/page.tsx"],h={require:n,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/ingredients/page",pathname:"/ingredients",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},6964:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,6346,23)),Promise.resolve().then(n.t.bind(n,7924,23)),Promise.resolve().then(n.t.bind(n,5656,23)),Promise.resolve().then(n.t.bind(n,99,23)),Promise.resolve().then(n.t.bind(n,8243,23)),Promise.resolve().then(n.t.bind(n,8827,23)),Promise.resolve().then(n.t.bind(n,2763,23)),Promise.resolve().then(n.t.bind(n,7173,23))},7241:(e,t,n)=>{Promise.resolve().then(n.bind(n,7339))},7339:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});let r=(0,n(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/martin.varnai/Projects/lunchplanner/lunchplanner-web/src/app/ingredients/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/martin.varnai/Projects/lunchplanner/lunchplanner-web/src/app/ingredients/page.tsx","default")},7389:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>l});var r=n(687),a=n(3210),i=n(1297),s=n(1552);function l(){let[e,t]=(0,a.useState)([]),[n,l]=(0,a.useState)(""),[o,d]=(0,a.useState)(null),[c,h]=(0,a.useState)(""),[u,p]=(0,a.useState)(""),[m,g]=(0,a.useState)(!1),y=async()=>{if(!n.trim()){p("Ingredient name cannot be empty");return}g(!0);try{await (0,i.NV)(n.trim());let e=await (0,i.Zy)();t(e),l(""),p("")}catch(e){p("Failed to add ingredient"),console.error(e)}finally{g(!1)}},x=e=>{d(e.id),h(e.name),p("")},f=()=>{d(null),h(""),p("")},b=async e=>{if(!c.trim()){p("Ingredient name cannot be empty");return}g(!0);try{await (0,i.T2)(e,c.trim());let n=await (0,i.Zy)();t(n),d(null),p("")}catch(e){p("Failed to update ingredient"),console.error(e)}finally{g(!1)}},w=async e=>{g(!0);try{let n=await (0,i.lu)(e);if(!n.success){p(`Cannot delete ingredient that is used in meal: ${n.mealWithIngredient?.title}`);return}let r=await (0,i.Zy)();t(r),p("")}catch(e){p("Failed to delete ingredient"),console.error(e)}finally{g(!1)}};return(0,r.jsx)(s.A,{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{children:"Ingredients"}),(0,r.jsx)("p",{className:"mb-4",children:"Manage your ingredients database."}),u&&(0,r.jsx)("div",{className:"card",style:{backgroundColor:"#ffebee",marginBottom:"1rem"},children:(0,r.jsx)("p",{style:{color:"var(--error-color)"},children:u})}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("h2",{children:"Add New Ingredient"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{type:"text",value:n,onChange:e=>l(e.target.value),placeholder:"Enter ingredient name",style:{marginBottom:0},disabled:m}),(0,r.jsx)("button",{onClick:y,disabled:m,children:m?"Adding...":"Add"})]})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("h2",{children:"Ingredients List"}),m&&0===e.length?(0,r.jsx)("p",{children:"Loading ingredients..."}):0===e.length?(0,r.jsx)("p",{children:"No ingredients added yet."}):(0,r.jsx)("ul",{style:{listStyle:"none"},children:e.map(e=>(0,r.jsx)("li",{className:"flex justify-between items-center",style:{padding:"0.75rem 0",borderBottom:"1px solid var(--border-color)"},children:o===e.id?(0,r.jsxs)("div",{className:"flex gap-2",style:{width:"100%"},children:[(0,r.jsx)("input",{type:"text",value:c,onChange:e=>h(e.target.value),style:{marginBottom:0},disabled:m}),(0,r.jsx)("button",{onClick:()=>b(e.id),disabled:m,children:m?"Saving...":"Save"}),(0,r.jsx)("button",{className:"secondary",onClick:f,disabled:m,children:"Cancel"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{children:e.name}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{className:"secondary",onClick:()=>x(e),disabled:m,children:"Edit"}),(0,r.jsx)("button",{style:{backgroundColor:"var(--error-color)"},onClick:()=>w(e.id),disabled:m,children:m?"Deleting...":"Delete"})]})]})},e.id))})]})]})})}},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9551:e=>{"use strict";e.exports=require("url")}};var t=require("../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[447,825,658,418],()=>n(6029));module.exports=r})();