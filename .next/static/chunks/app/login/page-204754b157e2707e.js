(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{722:(e,t,a)=>{"use strict";a.d(t,{R2:()=>l,a7:()=>u,cQ:()=>c,gw:()=>d});let s="lunchplanner_token",n=()=>localStorage.getItem(s),i=e=>{localStorage.setItem(s,e)},r=()=>{localStorage.removeItem(s)},o=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n(),s={"Content-Type":"application/json",...a?{Authorization:"Bearer ".concat(a)}:{},...t.headers||{}},i=await fetch("".concat("http://localhost:3000/api").concat(e),{...t,headers:s});if(401===i.status)throw r(),window.location.href="/login",Error("Unauthorized");let o=await i.json();if(!i.ok)throw Error(o.message||"API request failed");return o},l={register:async(e,t,a)=>{let s=await o("/auth/register",{method:"POST",body:JSON.stringify({name:e,email:t,password:a})});return s.token&&i(s.token),s},login:async(e,t)=>{let a=await o("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})});return a.token&&i(a.token),a},logout:()=>{r()},getCurrentUser:async()=>await o("/auth/me"),changePassword:async(e,t)=>await o("/auth/change-password",{method:"POST",body:JSON.stringify({currentPassword:e,newPassword:t})})},c={getAll:async()=>await o("/ingredients"),getById:async e=>await o("/ingredients/".concat(e)),create:async e=>await o("/ingredients",{method:"POST",body:JSON.stringify({name:e})}),update:async(e,t)=>await o("/ingredients/".concat(e),{method:"PUT",body:JSON.stringify({name:t})}),delete:async e=>await o("/ingredients/".concat(e),{method:"DELETE"})},d={getAll:async()=>await o("/meals"),getById:async e=>await o("/meals/".concat(e)),create:async(e,t)=>await o("/meals",{method:"POST",body:JSON.stringify({title:e,ingredients:t})}),update:async(e,t,a)=>await o("/meals/".concat(e),{method:"PUT",body:JSON.stringify({title:t,ingredients:a})}),delete:async e=>await o("/meals/".concat(e),{method:"DELETE"})},u={getAll:async()=>await o("/plans"),updateDay:async(e,t)=>await o("/plans/".concat(e),{method:"PUT",body:JSON.stringify({mealIds:t})}),reset:async()=>await o("/plans",{method:"DELETE"}),getShoppingList:async()=>await o("/plans/shopping-list")}},4748:(e,t,a)=>{Promise.resolve().then(a.bind(a,9690))},5695:(e,t,a)=>{"use strict";var s=a(8999);a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},9690:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var s=a(5155),n=a(2115),i=a(5695),r=a(722);function o(){let[e,t]=(0,n.useState)(""),[a,o]=(0,n.useState)(""),[l,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)(""),[h,g]=(0,n.useState)(""),[m,y]=(0,n.useState)(!1),p=(0,i.useRouter)(),w=async t=>{t.preventDefault(),g(""),y(!0);try{await r.R2.login(e,a),p.push("/")}catch(e){g(e.message||"Login failed")}finally{y(!1)}},f=async t=>{t.preventDefault(),g(""),y(!0);try{await r.R2.register(d,e,a),p.push("/")}catch(e){g(e.message||"Registration failed")}finally{y(!1)}};return(0,s.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,s.jsxs)("div",{className:"card",style:{maxWidth:"400px",width:"100%"},children:[(0,s.jsx)("h1",{children:l?"Register":"Login"}),h&&(0,s.jsx)("div",{style:{backgroundColor:"#ffebee",padding:"1rem",marginBottom:"1rem",borderRadius:"4px"},children:(0,s.jsx)("p",{style:{color:"var(--error-color)",margin:0},children:h})}),(0,s.jsxs)("form",{onSubmit:l?f:w,children:[l&&(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"name",children:"Name"}),(0,s.jsx)("input",{id:"name",type:"text",value:d,onChange:e=>u(e.target.value),required:!0,disabled:m})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"email",children:"Email"}),(0,s.jsx)("input",{id:"email",type:"email",value:e,onChange:e=>t(e.target.value),required:!0,disabled:m})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"password",children:"Password"}),(0,s.jsx)("input",{id:"password",type:"password",value:a,onChange:e=>o(e.target.value),required:!0,disabled:m})]}),(0,s.jsx)("button",{type:"submit",disabled:m,style:{width:"100%",marginTop:"1rem"},children:m?"Processing...":l?"Register":"Login"})]}),(0,s.jsx)("div",{style:{marginTop:"1rem",textAlign:"center"},children:(0,s.jsx)("button",{onClick:()=>c(!l),className:"link-button",disabled:m,children:l?"Already have an account? Login":"Need an account? Register"})})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(4748)),_N_E=e.O()}]);